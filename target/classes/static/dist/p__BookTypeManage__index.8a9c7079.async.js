"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[923],{48803:function(ue,A,n){var P=n(26118),g=n(28992);A.Z=function(M){var a=M.children,F=M.canSeeRole,y=(0,P.useModel)("@@initialState"),x=y.initialState,m=(0,g.Z)(x),T=m.canSeeAdmin,Z=m.canSeeReader;return F==="Admin"?T?a:null:F==="Reader"?Z?a:null:F===void 0&&(T||Z)?a:null}},44985:function(ue,A,n){n.r(A),n.d(A,{default:function(){return be}});var P=n(48305),g=n.n(P),M=n(90228),a=n.n(M),F=n(26068),y=n.n(F),x=n(87999),m=n.n(x),T=n(26118);function Z(i,e){return D.apply(this,arguments)}function D(){return D=m()(a()().mark(function i(e,u){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,T.request)("/bookType/getList",y()({method:"GET",params:y()({},e)},u||{})));case 1:case"end":return r.stop()}},i)})),D.apply(this,arguments)}function se(i,e){return V.apply(this,arguments)}function V(){return V=m()(a()().mark(function i(e,u){return a()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,T.request)("/bookType/add",y()({method:"POST",headers:{"Content-Type":"application/json"},data:e},u||{})));case 1:case"end":return r.stop()}},i)})),V.apply(this,arguments)}function Fe(i,e){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime().mark(function i(e,u){var t;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return t=e.bookTypeId,d.abrupt("return",request("/v1/bookType/".concat(t),_objectSpread({method:"GET",params:_objectSpread({},e)},u||{})));case 2:case"end":return d.stop()}},i)})),L.apply(this,arguments)}function le(i,e,u){return I.apply(this,arguments)}function I(){return I=m()(a()().mark(function i(e,u,t){var r;return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return r=e.id,s.abrupt("return",(0,T.request)("/bookType/update/".concat(r),y()({method:"PUT",headers:{"Content-Type":"application/json"},params:y()({},e),data:u},t||{})));case 2:case"end":return s.stop()}},i)})),I.apply(this,arguments)}function ie(i,e){return N.apply(this,arguments)}function N(){return N=m()(a()().mark(function i(e,u){var t;return a()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return t=e.ids,d.abrupt("return",(0,T.request)("/bookType/delete/".concat(t),y()({method:"DELETE",params:y()({},e)},u||{})));case 2:case"end":return d.stop()}},i)})),N.apply(this,arguments)}var oe=n(28992),W=n(48803),de=n(99505),K=n(93378),ce=n(22421),pe=n(7389),U=n(48049),J=n(73694),fe=n(34830),b=n(75271),Q=n(86073),l=n(52676),he=function(e){var u=e.modalVisible,t=e.onCancel;return(0,l.jsx)(Q.Z,{destroyOnClose:!0,title:"\u65B0\u589E",width:420,open:u,onCancel:function(){return t()},footer:null,children:e.children})},me=he,Y=n(51560),H=n(42410),Be=function(e,u){for(var t=[],r=e;r<u;r++)t.push(r);return t},ve=function(e){return(0,l.jsx)(Y.L0,{stepsProps:{size:"small"},stepsFormRender:function(t,r){return(0,l.jsx)(Q.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u4FEE\u6539",open:e.updateModalVisible,footer:r,onCancel:function(){return e.onCancel()},children:t})},onFinish:e.onSubmit,children:(0,l.jsxs)(Y.L0.StepForm,{initialValues:{typeName:e.values.typeName,typeDesc:e.values.typeDesc},title:"\u4FEE\u6539\u56FE\u4E66\u7C7B\u578B",children:[(0,l.jsx)(H.Z,{width:"md",name:"typeName",label:"\u56FE\u4E66\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u8F93\u5165"}]}),(0,l.jsx)(H.Z,{width:"md",name:"typeDesc",label:"\u63CF\u8FF0"})]})})},ye=ve,Se=function(){var i=m()(a()().mark(function e(u){var t,r;return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=U.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),s.prev=1,s.next=4,se(y()({},u));case 4:if(r=s.sent,t(),r.code!==2e4){s.next=10;break}return s.abrupt("return",!0);case 10:return s.abrupt("return",!1);case 11:s.next=17;break;case 13:return s.prev=13,s.t0=s.catch(1),t(),s.abrupt("return",!1);case 17:case"end":return s.stop()}},e,null,[[1,13]])}));return function(u){return i.apply(this,arguments)}}(),ge=function(){var i=m()(a()().mark(function e(u,t){var r,d;return a()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return r=U.ZP.loading("\u6B63\u5728\u66F4\u65B0"),p.prev=1,p.next=4,le({id:u||""},{typeName:t.typeName||"",typeDesc:t.typeDesc||""});case 4:if(d=p.sent,r(),d.code!==2e4){p.next=10;break}return p.abrupt("return",!0);case 10:return p.abrupt("return",!1);case 11:p.next=17;break;case 13:return p.prev=13,p.t0=p.catch(1),r(),p.abrupt("return",!1);case 17:case"end":return p.stop()}},e,null,[[1,13]])}));return function(u,t){return i.apply(this,arguments)}}(),Te=function(){var i=m()(a()().mark(function e(u){var t,r,d,s=arguments;return a()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(t=s.length>1&&s[1]!==void 0?s[1]:3,r=U.ZP.loading("\u6B63\u5728\u5220\u9664"),u){f.next=4;break}return f.abrupt("return",!0);case 4:return f.prev=4,f.next=7,ie({ids:u.map(function(k){return k.id}).filter(function(k){return k!=null}).join(",")});case 7:return d=f.sent,r(),f.abrupt("return",!0);case 12:return f.prev=12,f.t0=f.catch(4),r(),f.abrupt("return",!1);case 16:case"end":return f.stop()}},e,null,[[4,12]])}));return function(u){return i.apply(this,arguments)}}(),Ce=function(){var e=(0,T.useModel)("@@initialState"),u=e.initialState,t=(0,oe.Z)(u),r=t.canSeeAdmin,d=(0,b.useState)(!1),s=g()(d,2),p=s[0],f=s[1],k=(0,b.useState)(!1),X=g()(k,2),Ae=X[0],Me=X[1],je=(0,b.useState)(!1),q=g()(je,2),we=q[0],O=q[1],ke=(0,b.useState)({}),_=g()(ke,2),$=_[0],z=_[1],E=(0,b.useRef)(),Ee=(0,b.useState)(),ee=g()(Ee,2),C=ee[0],re=ee[1],Re=(0,b.useState)([]),ne=g()(Re,2),B=ne[0],ae=ne[1],G=[{title:"id",dataIndex:"id",valueType:"text",hideInForm:!0},{title:"\u56FE\u4E66\u7C7B\u578B\u540D",dataIndex:"typeName",valueType:"text",formItemProps:{rules:[{required:!0,message:"\u5FC5\u586B\u9879"}]}},{title:"\u63CF\u8FF0",dataIndex:"typeDesc",valueType:"text",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(c,o){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W.Z,{canSeeRole:"Admin",children:(0,l.jsx)("a",{onClick:function(){O(!0),z(o)},children:"\u4FEE\u6539"})}),(0,l.jsx)("a",{onClick:function(){return re(o)},style:{marginLeft:8},children:"\u67E5\u770B"})]})}}];return(0,l.jsxs)(de._z,{header:{title:"\u7528\u6237\u7BA1\u7406"},children:[(0,l.jsx)(K.Z,{pagination:{pageSize:10,showQuickJumper:!0},headerTitle:"\u67E5\u8BE2\u8868\u683C",actionRef:E,rowKey:"id",search:{labelWidth:120},toolBarRender:function(){return[(0,l.jsx)(W.Z,{canSeeRole:"Admin",children:(0,l.jsx)(J.ZP,{type:"primary",onClick:function(){return f(!0)},children:"\u65B0\u589E"},"1")})]},request:function(){var h=m()(a()().mark(function c(o,S,j){var v,w,te;return a()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,Z({pageNum:o.current,pageSize:o.pageSize,id:o.id,typeName:o.typeName});case 2:return v=R.sent,w=v.data,te=v.success,R.abrupt("return",{data:(w==null?void 0:w.list)||[],total:(w==null?void 0:w.total)||5,success:te});case 6:case"end":return R.stop()}},c)}));return function(c,o,S){return h.apply(this,arguments)}}(),columns:G,rowSelection:r?{onChange:function(c,o){return ae(o)},getCheckboxProps:function(c){return{disabled:!r}}}:void 0}),(B==null?void 0:B.length)>0&&(0,l.jsx)(ce.S,{extra:(0,l.jsxs)("div",{children:["\u5DF2\u9009\u62E9"," ",(0,l.jsx)("a",{style:{fontWeight:600},children:B.length})," ","\u9879\xA0\xA0"]}),children:(0,l.jsx)(J.ZP,{type:"primary",onClick:m()(a()().mark(function h(){var c,o;return a()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,Te(B);case 2:ae([]),(c=E.current)===null||c===void 0||(o=c.reloadAndRest)===null||o===void 0||o.call(c);case 4:case"end":return j.stop()}},h)})),children:"\u6279\u91CF\u5220\u9664"})}),(0,l.jsx)(me,{onCancel:function(){return f(!1)},modalVisible:p,children:(0,l.jsx)(K.Z,{onSubmit:function(){var h=m()(a()().mark(function c(o){var S;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,Se(o);case 2:S=v.sent,S&&(f(!1),E.current&&E.current.reload());case 4:case"end":return v.stop()}},c)}));return function(c){return h.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:G})}),$&&Object.keys($).length?(0,l.jsx)(ye,{onSubmit:function(){var h=m()(a()().mark(function c(o){var S;return a()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,ge($.id,o);case 2:S=v.sent,S&&(O(!1),z({}),E.current&&E.current.reload());case 4:case"end":return v.stop()}},c)}));return function(c){return h.apply(this,arguments)}}(),onCancel:function(){O(!1),z({})},updateModalVisible:we,values:$}):null,(0,l.jsx)(fe.Z,{width:600,open:!!C,onClose:function(){re(void 0)},closable:!1,children:(C==null?void 0:C.id)&&(0,l.jsx)(pe.vY,{column:2,title:"\u56FE\u4E66\u7C7B\u578B\u8BE6\u60C5",request:m()(a()().mark(function h(){return a()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",{data:C||{}});case 1:case"end":return o.stop()}},h)})),params:{id:C==null?void 0:C.id},columns:G})})]})},be=Ce}}]);
